import React, { useRef, useState } from 'react'
import Head from 'next/head';
import { GetServerSideProps, NextPage } from 'next';
import ProductItem from '@/components/ProductItem';
import { ProductType } from '@/types/types';
import { useRouter } from 'next/router';
import PrimaryBtn from '@/components/PrimaryBtn';
import Breadcrumbs from '@/components/Breadcrumbs';



interface Props {
//   products: ProductType[];
  searchedProductsData: ProductType[];
}

const ProductPage: NextPage<Props> = ({  searchedProductsData }) => {


    const breadcrumbs = [
        { name: 'Почетна', url: '/' },
        { name: 'Сите', url: '/products' },
        ];
    
    const router = useRouter();

    const [toggleSearch, setToggleSearch] = useState(false);
    // const [sortedProducts,setSortedProducts] = useState(searchedProductsData)

    const searchRef = useRef<HTMLInputElement>(null);
    const [currentPage, setCurrentPage] = useState<number>(1);

    const isQueryEmpty = Object.keys(router.query).length === 0;

    const handleFilterBySubcategory = (subcategory: string) => {
        router.push({
        pathname: "/products",
        query: {
            ...router.query,
            subcategory: subcategory,
        },
        });
        setCurrentPage(1);
    };

    const handleFilterByQ = (q: string) => {
        router.push({
        pathname: "/products",
        query: {
            ...router.query,
            q: q,
        },
        });
        setCurrentPage(1);
    };

    const filteringBySearchRefValue = (value: string | undefined) => {
        searchRef.current?.value === ""
        ? router.push({
            pathname: "/products",
            })
        : router.push({
            pathname: "/products",
            query: {
                ...router.query,
                q: value,
            },
            });
        setCurrentPage(1);
    };

    const totalPages = Math.ceil(searchedProductsData.length / 10);

    const start = (currentPage - 1) * 10;
    const end = start + 10;
    const paginationProductsForDisplaying = searchedProductsData.slice(start, end);

    const handlePage = (page: number) => {
        setCurrentPage(page);
    };

    // function isArray(value: any): value is any[] {
    //     return value && typeof value === 'object' && value.constructor === Array;
    // }

    // const filteredProducts = products.filter((p) => {
    //     if (!color) return true;

    //     const productColors = p.color.split(', ');
    //     return color.every((c) => productColors.includes(c));
    // });


    const handleToggleSearch = () => {
        setToggleSearch(!toggleSearch);
    }

    // const handleSortByDate = () => {
    // const sortedData = [...products].sort((a, b) => {
    //     const dateA = new Date(a.date).getTime();
    //     const dateB = new Date(b.date).getTime();
    //     return dateB - dateA;
    // });
    //     setSortedProducts(sortedData);
    // };



  return (
    <>
      <Head>
        <title>Igralishte-Product</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
        <div className='col-12 p-0 search-navbar'>
            <div className={`${toggleSearch ? "activeSearch" : "search"} flex-column justify-content-start text-left`}>
            <div className="col-10 p-0 my-5 mr-auto ml-auto">
                <div className="wrap-search-header flex-w p-l-15 align-items-center">
                    <div className="col-12 p-0 m-0 text-center mr-auto ml-auto">
                        <input
                            className="w-100 pl-3"
                            style={{height: '34px'}}
                            // type="search"
                            type="text"
                            name="search-product"
                            placeholder="Пребарувај ..."
                            ref={searchRef}
                            onChange={() => {
                            filteringBySearchRefValue(searchRef.current?.value);
                            }}/>
                             {/* onChange={(event) => {
                             event.preventDefault();
                             router.push({
                             pathname: "/products",
                             query: {
                                 ...router.query,
                                 query: event.target.value,
                                 },
                             });
                         }} */}
                            
                    <img src="../pictures/icons/search.png" className="btn-search btn-search-products" alt="search close btn" onClick={handleToggleSearch}/>
                    </div>
                </div>
                <ul>
                    <li  className="flex-column justify-content-start">
                    <p className="menu-list w-100 mt-5">
                        Категорија
                    </p>
                    <hr className='ml-0 mb-2 mt-3 w-50' style={{paddingBottom: '0.5px', background: "linear-gradient(99.4deg, #FFF0BF -10.68%, #EFC990 100%, #FDD292 100%, rgba(240, 199, 73, 0.42) 81.17%, #D4AF37 100%)"}}/>
                    <div className="d-flex flex-column mr-auto ">
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                data-filter=".tops"
                                onClick={() => {
                                    handleToggleSearch();
                                    handleFilterBySubcategory("tops");
                                    // router.push({
                                    //     pathname: "/products",
                                    //     query: {
                                    //         ...router.query,
                                    //         subcategory: "tops",
                                    //         },
                                    // });
                                }} />
                            <p className="p-0 ml-3" >Блузи</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                data-filter=".pants"
                                onClick={() => {
                                    handleToggleSearch();
                                    handleFilterBySubcategory("pants");
                                    // router.push({
                                    //     pathname: "/products",
                                    //     query: {
                                    //         ...router.query,
                                    //         subcategory: "pants",
                                    //     }
                                    // });
                                }} />
                            <p className="p-0 ml-3" >Панталони</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                data-filter=".bottomsShorts"
                                onClick={() => {
                                    handleToggleSearch();
                                    handleFilterBySubcategory("bottomsShorts");

                                    // router.push({
                                    //     pathname: "/products",
                                    //     query: {
                                    //         ...router.query,
                                    //         subcategory: "bottomsShorts",
                                    //         },
                                    // });
                                }} />
                            <p className="p-0 ml-3" >Здолништа / шорцеви</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            subcategory: "dresses",
                                            },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Фустани</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            subcategory: "coatsAndJackets",
                                            },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Палта и јакни</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            subcategory: "underwear",
                                            },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Долна облека</p>
                        </div>                        
                    </div>
                    </li>
                    <li  className="flex-column justify-content-start">
                    <p className="menu-list w-100 mt-5">
                        Брендови
                    </p>
                    <hr className='ml-0 mb-2 mt-3 w-50' style={{paddingBottom: '0.5px', background: "linear-gradient(99.4deg, #FFF0BF -10.68%, #EFC990 100%, #FDD292 100%, rgba(240, 199, 73, 0.42) 81.17%, #D4AF37 100%)"}}/>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            brand: "pincPartywear",
                                            },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Pinc Partywear</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            brand: "factoryGirl",
                                            },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Factory Girl</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            brand: "mainDays",
                                            },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Main Days</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            brand: "nezno",
                                            },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Нежно</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            brand: "red",
                                            },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Ред</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            brand: "nas",
                                            },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Наш</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            brand: "zsDaNe",
                                            },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Зш да не</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            brand: "fraeil",
                                            },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Fraeil</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            brand: "urma",
                                            },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Urma</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            brand: "candleNest",
                                            },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Candle Nest</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            brand: "beyondGreen",
                                            },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Beyond Green</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            brand: "gatta",
                                            },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Gatta</p>
                        </div>
                    </li>
                    <li  className="flex-column justify-content-start">
                    <p className="menu-list w-100 mt-5">
                        Аксесоари
                    </p>
                    <hr className='ml-0 mb-2 mt-3 w-50' style={{paddingBottom: '0.5px', background: "linear-gradient(99.4deg, #FFF0BF -10.68%, #EFC990 100%, #FDD292 100%, rgba(240, 199, 73, 0.42) 81.17%, #D4AF37 100%)"}}/>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    const { category, ...rest } = router.query;
                                    router.replace({
                                    pathname: "/products",
                                    query: {
                                        ...rest,
                                        ...router.query,
                                        subcategory: "purses",
                                        },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Ташни</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    const { category, ...rest } = router.query;
                                    router.replace({
                                    pathname: "/products",
                                    query: {
                                        ...rest,
                                        ...router.query,
                                        subcategory: "jewelry",
                                        },
                                    });
                                }} />
                            <p className="p-0 ml-3" >Накит</p>
                        </div>
                    </li>
                    <li  className="flex-column justify-content-start">
                    <p className="menu-list w-100 mt-5">
                        Величина
                    </p>
                    <hr className='ml-0 mb-2 mt-3 w-50' style={{paddingBottom: '0.5px', background: "linear-gradient(99.4deg, #FFF0BF -10.68%, #EFC990 100%, #FDD292 100%, rgba(240, 199, 73, 0.42) 81.17%, #D4AF37 100%)"}}/>
                    <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            size: "XL",
                                        }
                                    });
                                }} />
                            <p className="p-0 ml-3" >XL</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            size: "L",
                                        }
                                    });
                                }} />
                            <p className="p-0 ml-3" >L</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            size: "M",
                                        }
                                    });
                                }} />
                            <p className="p-0 ml-3" >M</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            size: "S",
                                        }
                                    });
                                }} />
                            <p className="p-0 ml-3" >S</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            size: "XS",
                                        }
                                    });
                                }} />
                            <p className="p-0 ml-3" >XS</p>
                        </div>
                    </li>
                    <li  className="flex-column justify-content-start">
                    <p className="menu-list w-100 mt-5">
                        Боја
                    </p>
                    <hr className='ml-0 mb-2 mt-3 w-25' style={{paddingBottom: '0.5px', background: "linear-gradient(99.4deg, #FFF0BF 0%, #EFC990 100%, #FDD292 100%)"}}/>
                    <div className="flex-row justify-content-start mt-3 mb-1">
                        <div className="input-group-text">
                            <input type="color" value="#ff0000" onChange={(event) => event?.target.value} aria-label="Checkbox for following text input" className="color-filter mr-2"
                                data-filter=".red"
                                onClick={(event: React.MouseEvent<HTMLElement>) => {
                                    event.preventDefault()
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            color: "red",
                                        },
                                    });
                                }} />
                        </div>
                        <div className="input-group-text">
                            <input type="color" value="#ffa500" onChange={(event) => event?.target.value} aria-label="Checkbox for following text input" className="color-filter mr-2"
                                data-filter=".orange"
                                onClick={(event: React.MouseEvent<HTMLElement>) => {
                                    event.preventDefault()
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            color: "orange",
                                        },
                                    });
                                }} />
                        </div>
                        <div className="input-group-text">
                            <input type="color" value="#ffff00" onChange={(event) => event?.target.value} aria-label="Checkbox for following text input" className="color-filter mr-2"
                                data-filter=".yellow"
                                onClick={(event: React.MouseEvent<HTMLElement>) => {
                                    event.preventDefault()
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            color: "yellow",
                                        },
                                    });
                                }} />
                        </div>
                        <div className="input-group-text">
                            <input type="color" value="#008000" onChange={(event) => event?.target.value} aria-label="Checkbox for following text input" className="color-filter mr-2"
                                data-filter=".greenw"
                                onClick={(event: React.MouseEvent<HTMLElement>) => {
                                    event.preventDefault()
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            color: "green",
                                        },
                                    });
                                }} />
                        </div>
                        <div className="input-group-text">
                            <input type="color" value="#0000ff" onChange={(event) => event?.target.value} aria-label="Checkbox for following text input" className="color-filter mr-2"
                                data-filter=".blue"
                                onClick={(event: React.MouseEvent<HTMLElement>) => {
                                    event.preventDefault()
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            color: "blue",
                                        },
                                    });
                                }} />
                        </div>
                    </div>
                    <div className="flex-row justify-content-start">                       
                        <div className="input-group-text">
                            <input type="color" value="#ffc0cb" onChange={(event) => event?.target.value} aria-label="Checkbox for following text input" className="color-filter mr-2"
                                onClick={(event: React.MouseEvent<HTMLElement>) => {
                                    event.preventDefault()
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            color: "pink",
                                        },
                                    });
                                }} />
                        </div>
                        <div className="input-group-text">
                            <input type="color" value="#ee82ee" onChange={(event) => event?.target.value} aria-label="Checkbox for following text input" className="color-filter mr-2"
                                onClick={(event: React.MouseEvent<HTMLElement>) => {
                                    event.preventDefault()
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            color: "purple",
                                        },
                                    });
                                }} />
                        </div>
                        <div className="input-group-text">
                            <input type="color" value="#808080" onChange={(event) => event?.target.value} aria-label="Checkbox for following text input" className="color-filter mr-2"
                                onClick={(event: React.MouseEvent<HTMLElement>) => {
                                    event.preventDefault()
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            color: "grey",
                                        },
                                    });
                                }} />
                        </div>
                        <div className="input-group-text" >
                            <input type="color" value="#ffffff" onChange={(event) => event?.target.value} aria-label="Checkbox for following text input" className="color-filter mr-2 border"
                                onClick={(event: React.MouseEvent<HTMLElement>) => {
                                    event.preventDefault()
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            color: "white",
                                        },
                                    });
                                }} />
                        </div>
                        <div className="input-group-text">
                            <input type="color" value="#000000" onChange={(event) => event?.target.value} aria-label="Checkbox for following text input" className="color-filter mr-2"
                                onClick={(event: React.MouseEvent<HTMLElement>) => {
                                    event.preventDefault()
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            color: "black",
                                        },
                                    });
                                }} />
                        </div>
                        </div>
                    </li>
                    <li  className="flex-column justify-content-start">
                    <p className="menu-list w-100 mt-5">
                        Цена
                    </p>
                    <hr className='ml-0 mb-2 mt-3 w-25' style={{paddingBottom: '0.5px', background: "linear-gradient(99.4deg, #FFF0BF -10.68%, #EFC990 100%, #FDD292 100%, rgba(240, 199, 73, 0.42) 81.17%, #D4AF37 100%)"}}/>
                    <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            discount: "discount",
                                        }
                                    });
                                }} />
                            <p className="p-0 ml-3" style={{color: "#FF5B29"}}>На попуст*</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            price: "price",
                                        }
                                    });
                                }} />
                            <p className="p-0 ml-3" >500 - 1000 ден.</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            price: "price",
                                        },
                                    });
                                }} />
                            <p className="p-0 ml-3" >1500 - 2000 ден.</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            price: "price",
                                        },
                                    });
                                }} />
                            <p className="p-0 ml-3" >2000 - 2500 ден.</p>
                        </div>
                        <div className="input-group-text">
                            <input type="checkbox" aria-label="Checkbox for following text input"
                                onClick={() => {
                                    handleToggleSearch();
                                    router.push({
                                        pathname: "/products",
                                        query: {
                                            ...router.query,
                                            price: "price",
                                        }
                                    });
                                }} />
                            <p className="p-0 ml-3" >Над 2500 ден.</p>
                        </div>
                    </li>
                   </ul>
            </div>
            <div className='col-11 p-0 text-center bottom-sticky mb-4 mr-auto ml-auto'>
                <PrimaryBtn title="Филтрирај" btnClass={"PrimaryBtn w-100 btn-gold btn-gold-text mb-3"} onClick={handleToggleSearch} backgroundColor={"btn-gold"} color='black' border='none' height="51px"/>
                <button className='border-0 bg-transparent w-100' onClick={handleToggleSearch}><u>oткажи</u></button>
            </div>
            </div>
        </div>
        {/* SEARCH LAYER END */}
        <div className="container-fluid my-5">
          <div  className="row flex-column">
            <div className="container-fluid">
              <div  className="row flex-row">
                <Breadcrumbs breadcrumbs={breadcrumbs} />
                <div className='col-12 flex-row justify-content-between align-items-center mb-3'>
                    <button onClick={handleToggleSearch} className='col-2 p-0 bg-transparent border-0'>
                        <img src="../../pictures/icons/search-group.png"/>
                    </button>
                    <div className="col-10 form-group flex-row flex-nowrap justify-content-end align-items-center p-0 mb-0">
                        <div className="col-11 align-self-center flex-row justify-content-end mr-3 p-0">
                        <label htmlFor="exampleFormControlSelect1" className='dropdown-sort align-self-center mb-0 mr-2'>Подреди според:</label>
                            <select className="form-control mr-1 px-2 py-1" id="exampleFormControlSelect1" style={{height: '5%'}}>
                                {/* <option className='dropdown-sort-select' onClick={handleSortByDate}>Најнови</option>
                                <option className='dropdown-sort-select' onClick={handleSortByDate}>Најстари</option> */}
                            </select>
                        </div>
                    </div>
                </div>
                <div className="col-12 flex-row flex-wrap justify-content-around">
                  <div className="row flex-row mr-auto ml-auto justify-content-around isotope-grid">
                    {searchedProductsData.length < 1 ? (
                    <p>There are no results for your search..</p>
                    ) : (
                        paginationProductsForDisplaying.map((product, productIndex) => {
                            let columnSize = "col-5 product-img-small";
                            let columnText = "product-text-a"
                            for (let i = 2; i < searchedProductsData.length; i += 5) {
                            if (productIndex === i ) {columnSize = "col-11"; columnText = "product-text"}}
                            return (
                                <div key={productIndex} className={`${columnSize} ${columnText} p-0 mb-2`}>
                                    <ProductItem key={product.id} {...product} />
                                </div>
                                )
                        })
                    )}
                  </div>
                   {/* pagination  */}
                    <div className="flex-l-m flex-w w-full p-t-10 m-lr--7">
                        {Array.from({ length: totalPages }, (undefined, index) => (
                        <a
                            key={index}
                            className={`flex-c-m how-pagination1 trans-04 m-all-7 pointer ${
                            currentPage === index + 1
                                ? "active-pagination1 text-white"
                                : ""
                            }`}
                            onClick={() => handlePage(index + 1)}>
                            {index + 1}
                        </a>
                        ))}
                    </div>
                </div>
              </div>
            </div>
          </div>
        </div>
    </>
  ); 
};

export default ProductPage;



 export const getServerSideProps: GetServerSideProps = async ({query}) => { 
     
    //  const page = parseInt(query.page as string, 10) || 1;
     
     // export const getServerSideProps: GetServerSideProps = async ({query}) => {

//  let resSearchedBlogsItems: Response;
//  let resSearchedProductsItems: Response;
//  let searchQuery = query.query || "";

//  if (searchQuery) {
//     [resSearchedBlogsItems, resSearchedProductsItems] = await Promise.all([
//       fetch(`http://localhost:5001/blogs?q=${query.query}`),
//       fetch(`http://localhost:5001/products?q=${query.query}`),
//     ]);
//  } else {
//     [resSearchedBlogsItems, resSearchedProductsItems] = await Promise.all([
//       fetch("http://localhost:5001/blogs"),
//       fetch("http://localhost:5001/products"),
//     ]);
//  }

//  const [searchedBlogsItemsData, searchedProductsItemsData ] = await Promise.all([
//     resSearchedBlogsItems.json(),
//     resSearchedProductsItems.json(),
//   ]);

let resSearchedProducts: Response;

  if (query.category && query.q) {
    resSearchedProducts = await fetch(
      `http://localhost:5001/products?category_like=${query.category}&q=${query.q}`
    );
  } else if (query.category) {
    resSearchedProducts = await fetch(
      `http://localhost:5001/products?category_like=${query.category}`
    );
  } else if (query.q) {
    resSearchedProducts = await fetch(`http://localhost:5001/products?q=${query.q}`);
  } else {
    resSearchedProducts = await fetch(`http://localhost:5001/products`);
  }
   


    // const constructUrl = (query: any, page: number) => {
    //     let url = 'http://localhost:5001/products?';

    //     for (const key in query) {
    //         if (query[key]) {
    //             url += `&${key}_like=${query[key]}&page=${page}`;
    //         }
    //     }

    //     return url;
    // }

    // let products: ProductType[] = [];

    // const url = constructUrl(query, page);

    // const resSearchedProducts: Response = await fetch(url)
    const searchedProductsData: ProductType[] = await resSearchedProducts.json();


return { 
    props: { 
        searchedProductsData
    },
    }
 }


